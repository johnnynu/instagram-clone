{"ast":null,"code":"var _jsxFileName = \"/Users/johnnynguyen/instagram-clone/src/App.js\";\nimport React from \"react\";\nimport { Switch, Route, useHistory, useLocation, Redirect } from \"react-router-dom\";\nimport FeedPage from \"./pages/feed\";\nimport ExplorePage from \"./pages/explore\";\nimport ProfilePage from \"./pages/profile\";\nimport PostPage from \"./pages/post\";\nimport EditProfilePage from \"./pages/edit-profile\";\nimport LoginPage from \"./pages/login\";\nimport SignUpPage from \"./pages/signup\";\nimport NotFoundPage from \"./pages/not-found\";\nimport PostModal from \"./components/post/PostModal\";\nimport { AuthContext } from \"./auth\";\nimport { useSubscription } from \"@apollo/react-hooks\";\nimport { ME } from \"./graphql/subscriptions\";\nimport LoadingScreen from \"./components/shared/LoadingScreen\";\nimport Darkmode from \"darkmode-js\";\nexport const UserContext = React.createContext();\n\nfunction App() {\n  var _location$state;\n\n  const {\n    authState\n  } = React.useContext(AuthContext);\n  const isAuth = authState.status === \"in\";\n  const userId = isAuth ? authState.user.uid : null;\n  const variables = {\n    userId\n  };\n  console.log(authState);\n  const {\n    data,\n    loading\n  } = useSubscription(ME, {\n    variables\n  });\n  const history = useHistory();\n  const location = useLocation();\n  const prevLocation = React.useRef(location);\n  const modal = (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.modal;\n  React.useEffect(() => {\n    if (history.action !== \"POP\" && !modal) {\n      prevLocation.current = location;\n    }\n  }, [location, modal, history.action]);\n  if (loading) return React.createElement(LoadingScreen, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  });\n\n  if (!isAuth) {\n    return React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }, React.createElement(Route, {\n      path: \"/accounts/login\",\n      component: LoginPage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/accounts/emailsignup\",\n      component: SignUpPage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }), React.createElement(Redirect, {\n      to: \"/accounts/login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }));\n  }\n\n  const isModalOpen = modal && prevLocation.current !== location;\n  const me = isAuth && data.length !== 0 ? data.users[0] : null;\n  const currentUserId = me.id;\n  return React.createElement(UserContext.Provider, {\n    value: {\n      me,\n      currentUserId\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(Switch, {\n    location: isModalOpen ? prevLocation.current : location,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    component: FeedPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/explore\",\n    component: ExplorePage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }), React.createElement(Route, {\n    exact: true,\n    path: \"/:username\",\n    component: ProfilePage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }), React.createElement(Route, {\n    exact: true,\n    path: \"/p/:postId\",\n    component: PostPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/accounts/edit\",\n    component: EditProfilePage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/accounts/login\",\n    component: LoginPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/accounts/emailsignup\",\n    component: SignUpPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"*\",\n    component: NotFoundPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  })), isModalOpen && React.createElement(Route, {\n    exact: true,\n    path: \"/p/:postId\",\n    component: PostModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/johnnynguyen/instagram-clone/src/App.js"],"names":["React","Switch","Route","useHistory","useLocation","Redirect","FeedPage","ExplorePage","ProfilePage","PostPage","EditProfilePage","LoginPage","SignUpPage","NotFoundPage","PostModal","AuthContext","useSubscription","ME","LoadingScreen","Darkmode","UserContext","createContext","App","authState","useContext","isAuth","status","userId","user","uid","variables","console","log","data","loading","history","location","prevLocation","useRef","modal","state","useEffect","action","current","isModalOpen","me","length","users","currentUserId","id"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  Switch,\n  Route,\n  useHistory,\n  useLocation,\n  Redirect\n} from \"react-router-dom\";\nimport FeedPage from \"./pages/feed\";\nimport ExplorePage from \"./pages/explore\";\nimport ProfilePage from \"./pages/profile\";\nimport PostPage from \"./pages/post\";\nimport EditProfilePage from \"./pages/edit-profile\";\nimport LoginPage from \"./pages/login\";\nimport SignUpPage from \"./pages/signup\";\nimport NotFoundPage from \"./pages/not-found\";\nimport PostModal from \"./components/post/PostModal\";\nimport { AuthContext } from \"./auth\";\nimport { useSubscription } from \"@apollo/react-hooks\";\nimport { ME } from \"./graphql/subscriptions\";\nimport LoadingScreen from \"./components/shared/LoadingScreen\";\nimport Darkmode from \"darkmode-js\";\n\nexport const UserContext = React.createContext();\n\nfunction App() {\n  const { authState } = React.useContext(AuthContext);\n  const isAuth = authState.status === \"in\";\n  const userId = isAuth ? authState.user.uid : null;\n  const variables = { userId };\n  console.log(authState);\n  const { data, loading } = useSubscription(ME, { variables });\n  const history = useHistory();\n  const location = useLocation();\n  const prevLocation = React.useRef(location);\n  const modal = location.state?.modal;\n\n  React.useEffect(() => {\n    if (history.action !== \"POP\" && !modal) {\n      prevLocation.current = location;\n    }\n  }, [location, modal, history.action]);\n\n  if (loading) return <LoadingScreen />;\n\n  if (!isAuth) {\n    return (\n      <Switch>\n        <Route path=\"/accounts/login\" component={LoginPage} />\n        <Route path=\"/accounts/emailsignup\" component={SignUpPage} />\n        <Redirect to=\"/accounts/login\" />\n      </Switch>\n    );\n  }\n\n  const isModalOpen = modal && prevLocation.current !== location;\n  const me = isAuth && data.length !== 0 ? data.users[0] : null;\n  const currentUserId = me.id;\n\n  return (\n    <UserContext.Provider value={{ me, currentUserId }}>\n      <Switch location={isModalOpen ? prevLocation.current : location}>\n        <Route exact path=\"/\" component={FeedPage} />\n        <Route path=\"/explore\" component={ExplorePage} />\n        <Route exact path=\"/:username\" component={ProfilePage} />\n        <Route exact path=\"/p/:postId\" component={PostPage} />\n        <Route path=\"/accounts/edit\" component={EditProfilePage} />\n        <Route path=\"/accounts/login\" component={LoginPage} />\n        <Route path=\"/accounts/emailsignup\" component={SignUpPage} />\n        <Route path=\"*\" component={NotFoundPage} />\n      </Switch>\n      {isModalOpen && <Route exact path=\"/p/:postId\" component={PostModal} />}\n    </UserContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}