{"ast":null,"code":"/*\n    zuck.js\n    https://github.com/ramon82/zuck.js\n    MIT License\n*/\nmodule.exports = (window => {\n  /* Utilities */\n  const query = function (qs) {\n    return document.querySelectorAll(qs)[0];\n  };\n\n  const get = function (array, what) {\n    if (array) {\n      return array[what] || '';\n    } else {\n      return '';\n    }\n  };\n\n  const each = function (arr, func) {\n    if (arr) {\n      const total = arr.length;\n\n      for (let i = 0; i < total; i++) {\n        func(i, arr[i]);\n      }\n    }\n  };\n\n  const setVendorVariable = function (ref, variable, value) {\n    const variables = [variable.toLowerCase(), `webkit${variable}`, `MS${variable}`, `o${variable}`];\n    each(variables, (i, val) => {\n      ref[val] = value;\n    });\n  };\n\n  const addVendorEvents = function (el, func, event) {\n    const events = [event.toLowerCase(), `webkit${event}`, `MS${event}`, `o${event}`];\n    each(events, (i, val) => {\n      el.addEventListener(val, func, false);\n    });\n  };\n\n  const onAnimationEnd = function (el, func) {\n    addVendorEvents(el, func, 'AnimationEnd');\n  };\n\n  const onTransitionEnd = function (el, func) {\n    if (!el.transitionEndEvent) {\n      el.transitionEndEvent = true;\n      addVendorEvents(el, func, 'TransitionEnd');\n    }\n  };\n\n  const prepend = function (parent, child) {\n    if (parent.firstChild) {\n      parent.insertBefore(child, parent.firstChild);\n    } else {\n      parent.appendChild(child);\n    }\n  };\n\n  const generateId = () => {\n    return 'stories-' + Math.random().toString(36).substr(2, 9);\n  };\n  /* Zuckera */\n\n\n  const ZuckJS = function (timeline, options) {\n    const zuck = this;\n\n    const option = function (name, prop) {\n      const type = function (what) {\n        return typeof what !== 'undefined';\n      };\n\n      if (prop) {\n        if (type(options[name])) {\n          return type(options[name][prop]) ? options[name][prop] : optionsDefault[name][prop];\n        } else {\n          return optionsDefault[name][prop];\n        }\n      } else {\n        return type(options[name]) ? options[name] : optionsDefault[name];\n      }\n    };\n\n    const fullScreen = function (elem, cancel) {\n      const func = 'RequestFullScreen';\n      const elFunc = 'requestFullScreen'; // crappy vendor prefixes.\n\n      try {\n        if (cancel) {\n          if (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement) {\n            if (document.exitFullscreen) {\n              document.exitFullscreen().catch(() => {});\n            } else if (document.mozCancelFullScreen) {\n              document.mozCancelFullScreen().catch(() => {});\n            } else if (document.mozCancelFullScreen) {\n              document.mozCancelFullScreen().catch(() => {});\n            }\n          }\n        } else {\n          if (elem[elFunc]) {\n            elem[elFunc]();\n          } else if (elem[`ms${func}`]) {\n            elem[`ms${func}`]();\n          } else if (elem[`moz${func}`]) {\n            elem[`moz${func}`]();\n          } else if (elem[`webkit${func}`]) {\n            elem[`webkit${func}`]();\n          }\n        }\n      } catch (e) {\n        console.warn('[Zuck.js] Can\\'t access fullscreen');\n      }\n    };\n\n    const translate = function (element, to, duration, ease) {\n      const direction = to > 0 ? 1 : -1;\n      const to3d = Math.abs(to) / query('#zuck-modal').offsetWidth * 90 * direction;\n\n      if (option('cubeEffect')) {\n        const scaling = to3d === 0 ? 'scale(0.95)' : 'scale(0.930,0.930)';\n        setVendorVariable(query('#zuck-modal-content').style, 'Transform', scaling);\n\n        if (to3d < -90 || to3d > 90) {\n          return false;\n        }\n      }\n\n      const transform = !option('cubeEffect') ? `translate3d(${to}px, 0, 0)` : `rotateY(${to3d}deg)`;\n\n      if (element) {\n        setVendorVariable(element.style, 'TransitionTimingFunction', ease);\n        setVendorVariable(element.style, 'TransitionDuration', `${duration}ms`);\n        setVendorVariable(element.style, 'Transform', transform);\n      }\n    };\n\n    const findPos = function (obj, offsetY, offsetX, stop) {\n      let curleft = 0;\n      let curtop = 0;\n\n      if (obj) {\n        if (obj.offsetParent) {\n          do {\n            curleft += obj.offsetLeft;\n            curtop += obj.offsetTop;\n\n            if (obj === stop) {\n              break;\n            }\n          } while (obj = obj.offsetParent);\n        }\n\n        if (offsetY) {\n          curtop = curtop - offsetY;\n        }\n\n        if (offsetX) {\n          curleft = curleft - offsetX;\n        }\n      }\n\n      return [curleft, curtop];\n    };\n\n    if (typeof timeline === 'string') {\n      timeline = document.getElementById(timeline);\n    }\n\n    if (!timeline.id) {\n      timeline.setAttribute('id', generateId());\n    }\n\n    const timeAgo = function (time) {\n      time = Number(time) * 1000;\n      const dateObj = new Date(time);\n      const dateStr = dateObj.getTime();\n      let seconds = (new Date().getTime() - dateStr) / 1000;\n      const language = option('language', 'time');\n      const formats = [[60, ` ${language.seconds}`, 1], // 60\n      [120, `1 ${language.minute}`, ''], // 60*2\n      [3600, ` ${language.minutes}`, 60], // 60*60, 60\n      [7200, `1 ${language.hour}`, ''], // 60*60*2\n      [86400, ` ${language.hours}`, 3600], // 60*60*24, 60*60\n      [172800, ` ${language.yesterday}`, ''], // 60*60*24*2\n      [604800, ` ${language.days}`, 86400]];\n      let currentFormat = 1;\n\n      if (seconds < 0) {\n        seconds = Math.abs(seconds);\n        currentFormat = 2;\n      }\n\n      let result = false;\n      each(formats, (formatKey, format) => {\n        if (seconds < format[0] && !result) {\n          if (typeof format[2] === 'string') {\n            result = format[currentFormat];\n          } else if (format !== null) {\n            result = Math.floor(seconds / format[2]) + format[1];\n          }\n        }\n      });\n\n      if (!result) {\n        const day = dateObj.getDate();\n        const month = dateObj.getMonth();\n        const year = dateObj.getFullYear();\n        return `${day}/${month + 1}/${year}`;\n      } else {\n        return result;\n      }\n    };\n    /* options */\n\n\n    const id = timeline.id;\n    const optionsDefault = {\n      rtl: false,\n      skin: 'snapgram',\n      avatars: true,\n      stories: [],\n      backButton: true,\n      backNative: false,\n      paginationArrows: false,\n      previousTap: true,\n      autoFullScreen: false,\n      openEffect: true,\n      cubeEffect: false,\n      list: false,\n      localStorage: true,\n      callbacks: {\n        onOpen: function (storyId, callback) {\n          callback();\n        },\n        onView: function (storyId) {},\n        onEnd: function (storyId, callback) {\n          callback();\n        },\n        onClose: function (storyId, callback) {\n          callback();\n        },\n        onNextItem: function (storyId, nextStoryId, callback) {\n          callback();\n        },\n        onNavigateItem: function (storyId, nextStoryId, callback) {\n          callback();\n        }\n      },\n      template: {\n        timelineItem(itemData) {\n          return `\n            <div class=\"story ${get(itemData, 'seen') === true ? 'seen' : ''}\">\n              <a class=\"item-link\" href=\"${get(itemData, 'link')}\">\n                <span class=\"item-preview\">\n                  <img lazy=\"eager\" src=\"${option('avatars') || !get(itemData, 'currentPreview') ? get(itemData, 'photo') : get(itemData, 'currentPreview')}\" />\n                </span>\n                <span class=\"info\" itemProp=\"author\" itemScope itemType=\"http://schema.org/Person\">\n                  <strong class=\"name\" itemProp=\"name\">${get(itemData, 'name')}</strong>\n                  <span class=\"time\">${get(itemData, 'lastUpdatedAgo')}</span>\n                </span>\n              </a>\n              \n              <ul class=\"items\"></ul>\n            </div>`;\n        },\n\n        timelineStoryItem(itemData) {\n          const reserved = ['id', 'seen', 'src', 'link', 'linkText', 'time', 'type', 'length', 'preview'];\n          let attributes = `\n            href=\"${get(itemData, 'src')}\"\n            data-link=\"${get(itemData, 'link')}\"\n            data-linkText=\"${get(itemData, 'linkText')}\"\n            data-time=\"${get(itemData, 'time')}\"\n            data-type=\"${get(itemData, 'type')}\"\n            data-length=\"${get(itemData, 'length')}\"\n          `;\n\n          for (const dataKey in itemData) {\n            if (reserved.indexOf(dataKey) === -1) {\n              attributes += ` data-${dataKey}=\"${itemData[dataKey]}\"`;\n            }\n          }\n\n          return `<a ${attributes}>\n                    <img loading=\"auto\" src=\"${get(itemData, 'preview')}\" />\n                  </a>`;\n        },\n\n        viewerItem(storyData, currentStoryItem) {\n          return `<div class=\"story-viewer\">\n                    <div class=\"head\">\n                      <div class=\"left\">\n                        ${option('backButton') ? '<a class=\"back\">&lsaquo;</a>' : ''}\n\n                        <span class=\"item-preview\">\n                          <img lazy=\"eager\" class=\"profilePhoto\" src=\"${get(storyData, 'photo')}\" />\n                        </span>\n\n                        <div class=\"info\">\n                          <strong class=\"name\">${get(storyData, 'name')}</strong>\n                          <span class=\"time\">${get(storyData, 'timeAgo')}</span>\n                        </div>\n                      </div>\n\n                      <div class=\"right\">\n                        <span class=\"time\">${get(currentStoryItem, 'timeAgo')}</span>\n                        <span class=\"loading\"></span>\n                        <a class=\"close\" tabIndex=\"2\">&times;</a>\n                      </div>\n                    </div>\n\n                    <div class=\"slides-pointers\">\n                      <div class=\"wrap\"></div>\n                    </div>\n\n                    ${option('paginationArrows') ? `<div class=\"slides-pagination\">\n                          <span class=\"previous\">&lsaquo;</span>\n                          <span class=\"next\">&rsaquo;</span>\n                        </div>` : ''}\n                  </div>`;\n        },\n\n        viewerItemPointer(index, currentIndex, item) {\n          return `<span \n                    class=\"${currentIndex === index ? 'active' : ''} ${get(item, 'seen') === true ? 'seen' : ''}\"\n                    data-index=\"${index}\" data-item-id=\"${get(item, 'id')}\">\n                      <b style=\"animation-duration:${get(item, 'length') === '' ? '3' : get(item, 'length')}s\"></b>\n                  </span>`;\n        },\n\n        viewerItemBody(index, currentIndex, item) {\n          return `<div \n                    class=\"item ${get(item, 'seen') === true ? 'seen' : ''} ${currentIndex === index ? 'active' : ''}\"\n                    data-time=\"${get(item, 'time')}\" data-type=\"${get(item, 'type')}\" data-index=\"${index}\" data-item-id=\"${get(item, 'id')}\">\n                    ${get(item, 'type') === 'video' ? `<video class=\"media\" muted webkit-playsinline playsinline preload=\"auto\" src=\"${get(item, 'src')}\" ${get(item, 'type')}></video>\n                        <b class=\"tip muted\">${option('language', 'unmute')}</b>` : `<img loading=\"auto\" class=\"media\" src=\"${get(item, 'src')}\" ${get(item, 'type')} />\n                    `}\n\n                    ${get(item, 'link') ? `<a class=\"tip link\" href=\"${get(item, 'link')}\" rel=\"noopener\" target=\"_blank\">\n                            ${!get(item, 'linkText') || get(item, 'linkText') === '' ? option('language', 'visitLink') : get(item, 'linkText')}\n                          </a>` : ''}\n                  </div>`;\n        }\n\n      },\n      language: {\n        unmute: 'Touch to unmute',\n        keyboardTip: 'Press space to see next',\n        visitLink: 'Visit link',\n        time: {\n          ago: 'ago',\n          hour: 'hour ago',\n          hours: 'hours ago',\n          minute: 'minute ago',\n          minutes: 'minutes ago',\n          fromnow: 'from now',\n          seconds: 'seconds ago',\n          yesterday: 'yesterday',\n          tomorrow: 'tomorrow',\n          days: 'days ago'\n        }\n      }\n    };\n    /* modal */\n\n    const ZuckModal = () => {\n      let modalZuckContainer = query('#zuck-modal');\n\n      if (!modalZuckContainer && !zuck.hasModal) {\n        zuck.hasModal = true;\n        modalZuckContainer = document.createElement('div');\n        modalZuckContainer.id = 'zuck-modal';\n\n        if (option('cubeEffect')) {\n          modalZuckContainer.className = 'with-cube';\n        }\n\n        modalZuckContainer.innerHTML = '<div id=\"zuck-modal-content\"></div>';\n        modalZuckContainer.style.display = 'none';\n        modalZuckContainer.setAttribute('tabIndex', '1');\n\n        modalZuckContainer.onkeyup = ({\n          keyCode\n        }) => {\n          const code = keyCode;\n\n          if (code === 27) {\n            modal.close();\n          } else if (code === 13 || code === 32) {\n            modal.next();\n          }\n        };\n\n        if (option('openEffect')) {\n          modalZuckContainer.classList.add('with-effects');\n        }\n\n        if (option('rtl')) {\n          modalZuckContainer.classList.add('rtl');\n        }\n\n        onTransitionEnd(modalZuckContainer, () => {\n          if (modalZuckContainer.classList.contains('closed')) {\n            modalContent.innerHTML = '';\n            modalZuckContainer.style.display = 'none';\n            modalZuckContainer.classList.remove('closed');\n            modalZuckContainer.classList.remove('animated');\n          }\n        });\n        document.body.appendChild(modalZuckContainer);\n      }\n\n      const modalContent = query('#zuck-modal-content');\n\n      const moveStoryItem = function (direction) {\n        const modalContainer = query('#zuck-modal');\n        let target = '';\n        let useless = '';\n        let transform = 0;\n        const modalSlider = query(`#zuck-modal-slider-${id}`);\n        const slideItems = {\n          previous: query('#zuck-modal .story-viewer.previous'),\n          next: query('#zuck-modal .story-viewer.next'),\n          viewing: query('#zuck-modal .story-viewer.viewing')\n        };\n\n        if (!slideItems.previous && !direction || !slideItems.next && direction) {\n          if (!option('rtl')) {\n            return false;\n          }\n        }\n\n        if (!direction) {\n          target = 'previous';\n          useless = 'next';\n        } else {\n          target = 'next';\n          useless = 'previous';\n        }\n\n        const transitionTime = 600;\n\n        if (option('cubeEffect')) {\n          if (target === 'previous') {\n            transform = modalContainer.slideWidth;\n          } else if (target === 'next') {\n            transform = modalContainer.slideWidth * -1;\n          }\n        } else {\n          transform = findPos(slideItems[target])[0] * -1;\n        }\n\n        translate(modalSlider, transform, transitionTime, null);\n        setTimeout(() => {\n          // set page data when transition complete\n          if (option('rtl')) {\n            const tmp = target;\n            target = useless;\n            useless = tmp;\n          }\n\n          if (target !== '' && slideItems[target] && useless !== '') {\n            const currentStory = slideItems[target].getAttribute('data-story-id');\n            zuck.internalData.currentStory = currentStory;\n            const oldStory = query(`#zuck-modal .story-viewer.${useless}`);\n\n            if (oldStory) {\n              oldStory.parentNode.removeChild(oldStory);\n            }\n\n            if (slideItems.viewing) {\n              slideItems.viewing.classList.add('stopped');\n              slideItems.viewing.classList.add(useless);\n              slideItems.viewing.classList.remove('viewing');\n            }\n\n            if (slideItems[target]) {\n              slideItems[target].classList.remove('stopped');\n              slideItems[target].classList.remove(target);\n              slideItems[target].classList.add('viewing');\n            }\n\n            const newStoryData = getStoryMorningGlory(target);\n\n            if (newStoryData) {\n              createStoryViewer(newStoryData, target);\n            }\n\n            const storyId = zuck.internalData.currentStory;\n            let items = query(`#zuck-modal [data-story-id=\"${storyId}\"]`);\n\n            if (items) {\n              items = items.querySelectorAll('[data-index].active');\n              const duration = items[0].firstElementChild;\n              zuck.data[storyId].currentItem = parseInt(items[0].getAttribute('data-index'), 10);\n              items[0].innerHTML = `<b style=\"${duration.style.cssText}\"></b>`;\n              onAnimationEnd(items[0].firstElementChild, () => {\n                zuck.nextItem(false);\n              });\n            }\n\n            translate(modalSlider, '0', 0, null);\n\n            if (items) {\n              const storyViewer = query(`#zuck-modal .story-viewer[data-story-id=\"${currentStory}\"]`);\n              playVideoItem(storyViewer, [items[0], items[1]], true);\n            }\n\n            option('callbacks', 'onView')(zuck.internalData.currentStory);\n          }\n        }, transitionTime + 50);\n      };\n\n      const createStoryViewer = function (storyData, className, forcePlay) {\n        const modalSlider = query(`#zuck-modal-slider-${id}`);\n        const storyItems = get(storyData, 'items');\n        storyData.timeAgo = storyItems && storyItems[0] ? timeAgo(get(storyItems[0], 'time')) : '';\n        let htmlItems = '';\n        let pointerItems = '';\n        const storyId = get(storyData, 'id');\n        const slides = document.createElement('div');\n        const currentItem = get(storyData, 'currentItem') || 0;\n        const exists = query(`#zuck-modal .story-viewer[data-story-id=\"${storyId}\"]`);\n\n        if (exists) {\n          return false;\n        }\n\n        slides.className = 'slides';\n        each(storyItems, (i, item) => {\n          item.timeAgo = timeAgo(get(item, 'time'));\n\n          if (currentItem > i) {\n            storyData.items[i].timeAgo = item.timeAgo;\n            storyData.items[i].seen = true;\n            item.seen = true;\n          }\n\n          pointerItems += option('template', 'viewerItemPointer')(i, currentItem, item);\n          htmlItems += option('template', 'viewerItemBody')(i, currentItem, item);\n        });\n        slides.innerHTML = htmlItems;\n        const video = slides.querySelector('video');\n\n        const addMuted = function (video) {\n          if (video.muted) {\n            storyViewer.classList.add('muted');\n          } else {\n            storyViewer.classList.remove('muted');\n          }\n        };\n\n        if (video) {\n          video.onwaiting = e => {\n            if (video.paused) {\n              storyViewer.classList.add('paused');\n              storyViewer.classList.add('loading');\n            }\n          };\n\n          video.onplay = () => {\n            addMuted(video);\n            storyViewer.classList.remove('stopped');\n            storyViewer.classList.remove('paused');\n            storyViewer.classList.remove('loading');\n          };\n\n          video.onload = video.onplaying = video.oncanplay = () => {\n            addMuted(video);\n            storyViewer.classList.remove('loading');\n          };\n\n          video.onvolumechange = () => {\n            addMuted(video);\n          };\n        }\n\n        const storyViewerWrap = document.createElement('div');\n        storyViewerWrap.innerHTML = option('template', 'viewerItem')(storyData, currentItem);\n        const storyViewer = storyViewerWrap.firstElementChild;\n        storyViewer.className = `story-viewer muted ${className} ${!forcePlay ? 'stopped' : ''} ${option('backButton') ? 'with-back-button' : ''}`;\n        storyViewer.setAttribute('data-story-id', storyId);\n        storyViewer.querySelector('.slides-pointers .wrap').innerHTML = pointerItems;\n        each(storyViewer.querySelectorAll('.close, .back'), (i, el) => {\n          el.onclick = e => {\n            e.preventDefault();\n            modal.close();\n          };\n        });\n        storyViewer.appendChild(slides);\n\n        if (className === 'viewing') {\n          playVideoItem(storyViewer, storyViewer.querySelectorAll(`[data-index=\"${currentItem}\"].active`), false);\n        }\n\n        each(storyViewer.querySelectorAll('.slides-pointers [data-index] > b'), (i, el) => {\n          onAnimationEnd(el, () => {\n            zuck.nextItem(false);\n          });\n        });\n\n        if (className === 'previous') {\n          prepend(modalSlider, storyViewer);\n        } else {\n          modalSlider.appendChild(storyViewer);\n        }\n      };\n\n      const createStoryTouchEvents = function (modalSliderElement) {\n        const modalContainer = query('#zuck-modal');\n        const enableMouseEvents = true;\n        const modalSlider = modalSliderElement;\n        let position = {};\n        let touchOffset = null;\n        let isScrolling = null;\n        let delta = null;\n        let timer = null;\n        let nextTimer = null;\n\n        const touchStart = function (event) {\n          const storyViewer = query('#zuck-modal .viewing');\n\n          if (event.target.nodeName === 'A') {\n            return;\n          }\n\n          const touches = event.touches ? event.touches[0] : event;\n          const pos = findPos(query('#zuck-modal .story-viewer.viewing'));\n          modalContainer.slideWidth = query('#zuck-modal .story-viewer').offsetWidth;\n          modalContainer.slideHeight = query('#zuck-modal .story-viewer').offsetHeight;\n          position = {\n            x: pos[0],\n            y: pos[1]\n          };\n          const clientX = touches.clientX;\n          const clientY = touches.clientY;\n          touchOffset = {\n            x: clientX,\n            y: clientY,\n            time: Date.now(),\n            valid: true\n          };\n\n          if (clientY < 80 || clientY > modalContainer.slideHeight - 80) {\n            touchOffset.valid = false;\n          } else {\n            event.preventDefault();\n            isScrolling = undefined;\n            delta = {};\n\n            if (enableMouseEvents) {\n              modalSlider.addEventListener('mousemove', touchMove);\n              modalSlider.addEventListener('mouseup', touchEnd);\n              modalSlider.addEventListener('mouseleave', touchEnd);\n            }\n\n            modalSlider.addEventListener('touchmove', touchMove);\n            modalSlider.addEventListener('touchend', touchEnd);\n\n            if (storyViewer) {\n              storyViewer.classList.add('paused');\n            }\n\n            pauseVideoItem();\n            timer = setTimeout(() => {\n              storyViewer.classList.add('longPress');\n            }, 600);\n            nextTimer = setTimeout(() => {\n              clearInterval(nextTimer);\n              nextTimer = false;\n            }, 250);\n          }\n        };\n\n        const touchMove = function (event) {\n          const touches = event.touches ? event.touches[0] : event;\n          const clientX = touches.clientX;\n          const clientY = touches.clientY;\n\n          if (touchOffset && touchOffset.valid) {\n            delta = {\n              x: clientX - touchOffset.x,\n              y: clientY - touchOffset.y\n            };\n\n            if (typeof isScrolling === 'undefined') {\n              isScrolling = !!(isScrolling || Math.abs(delta.x) < Math.abs(delta.y));\n            }\n\n            if (!isScrolling && touchOffset) {\n              event.preventDefault();\n              translate(modalSlider, position.x + delta.x, 0, null);\n            }\n          }\n        };\n\n        const touchEnd = function (event) {\n          const storyViewer = query('#zuck-modal .viewing');\n          const lastTouchOffset = touchOffset;\n          const duration = touchOffset ? Date.now() - touchOffset.time : undefined;\n          const isValid = Number(duration) < 300 && Math.abs(delta.x) > 25 || Math.abs(delta.x) > modalContainer.slideWidth / 3;\n          const direction = delta.x < 0;\n          const index = direction ? query('#zuck-modal .story-viewer.next') : query('#zuck-modal .story-viewer.previous');\n          const isOutOfBounds = direction && !index || !direction && !index;\n\n          if (touchOffset && !touchOffset.valid) {} else {\n            if (delta) {\n              if (!isScrolling) {\n                if (isValid && !isOutOfBounds) {\n                  moveStoryItem(direction);\n                } else {\n                  translate(modalSlider, position.x, 300);\n                }\n              }\n\n              touchOffset = undefined;\n\n              if (enableMouseEvents) {\n                modalSlider.removeEventListener('mousemove', touchMove);\n                modalSlider.removeEventListener('mouseup', touchEnd);\n                modalSlider.removeEventListener('mouseleave', touchEnd);\n              }\n\n              modalSlider.removeEventListener('touchmove', touchMove);\n              modalSlider.removeEventListener('touchend', touchEnd);\n            }\n\n            const video = zuck.internalData.currentVideoElement;\n\n            if (timer) {\n              clearInterval(timer);\n            }\n\n            if (storyViewer) {\n              playVideoItem(storyViewer, storyViewer.querySelectorAll('.active'), false);\n              storyViewer.classList.remove('longPress');\n              storyViewer.classList.remove('paused');\n            }\n\n            if (nextTimer) {\n              clearInterval(nextTimer);\n              nextTimer = false;\n\n              const navigateItem = function () {\n                if (!direction) {\n                  if (lastTouchOffset.x > window.screen.availWidth / 3 || !option('previousTap')) {\n                    if (option('rtl')) {\n                      zuck.navigateItem('previous', event);\n                    } else {\n                      zuck.navigateItem('next', event);\n                    }\n                  } else {\n                    if (option('rtl')) {\n                      zuck.navigateItem('next', event);\n                    } else {\n                      zuck.navigateItem('previous', event);\n                    }\n                  }\n                }\n              };\n\n              const storyViewerViewing = query('#zuck-modal .viewing');\n\n              if (storyViewerViewing && video) {\n                if (storyViewerViewing.classList.contains('muted')) {\n                  unmuteVideoItem(video, storyViewerViewing);\n                } else {\n                  navigateItem();\n                }\n              } else {\n                navigateItem();\n                return false;\n              }\n            }\n          }\n        };\n\n        modalSlider.addEventListener('touchstart', touchStart);\n\n        if (enableMouseEvents) {\n          modalSlider.addEventListener('mousedown', touchStart);\n        }\n      };\n\n      return {\n        show(storyId, page) {\n          const modalContainer = query('#zuck-modal');\n\n          const callback = function () {\n            modalContent.innerHTML = `<div id=\"zuck-modal-slider-${id}\" class=\"slider\"></div>`;\n            const storyData = zuck.data[storyId];\n            const currentItem = storyData.currentItem || 0;\n            const modalSlider = query(`#zuck-modal-slider-${id}`);\n            createStoryTouchEvents(modalSlider);\n            zuck.internalData.currentStory = storyId;\n            storyData.currentItem = currentItem;\n\n            if (option('backNative')) {\n              window.location.hash = `#!${id}`;\n            }\n\n            const previousItemData = getStoryMorningGlory('previous');\n\n            if (previousItemData) {\n              createStoryViewer(previousItemData, 'previous');\n            }\n\n            createStoryViewer(storyData, 'viewing', true);\n            const nextItemData = getStoryMorningGlory('next');\n\n            if (nextItemData) {\n              createStoryViewer(nextItemData, 'next');\n            }\n\n            if (option('autoFullScreen')) {\n              modalContainer.classList.add('fullscreen');\n            }\n\n            const tryFullScreen = function () {\n              if (modalContainer.classList.contains('fullscreen') && option('autoFullScreen') && window.screen.availWidth <= 1024) {\n                fullScreen(modalContainer);\n              }\n\n              modalContainer.focus();\n            };\n\n            if (option('openEffect')) {\n              const storyEl = query(`#${id} [data-id=\"${storyId}\"] .item-preview`);\n              const pos = findPos(storyEl);\n              modalContainer.style.marginLeft = `${pos[0] + storyEl.offsetWidth / 2}px`;\n              modalContainer.style.marginTop = `${pos[1] + storyEl.offsetHeight / 2}px`;\n              modalContainer.style.display = 'block';\n              modalContainer.slideWidth = query('#zuck-modal .story-viewer').offsetWidth;\n              setTimeout(() => {\n                modalContainer.classList.add('animated');\n              }, 10);\n              setTimeout(() => {\n                tryFullScreen();\n              }, 300); // because effects\n            } else {\n              modalContainer.style.display = 'block';\n              modalContainer.slideWidth = query('#zuck-modal .story-viewer').offsetWidth;\n              tryFullScreen();\n            }\n\n            option('callbacks', 'onView')(storyId);\n          };\n\n          option('callbacks', 'onOpen')(storyId, callback);\n        },\n\n        next(unmute) {\n          const callback = function () {\n            const lastStory = zuck.internalData.currentStory;\n            const lastStoryTimelineElement = query(`#${id} [data-id=\"${lastStory}\"]`);\n\n            if (lastStoryTimelineElement) {\n              lastStoryTimelineElement.classList.add('seen');\n              zuck.data[lastStory].seen = true;\n              zuck.internalData.seenItems[lastStory] = true;\n              saveLocalData('seenItems', zuck.internalData.seenItems);\n              updateStorySeenPosition();\n            }\n\n            const stories = query('#zuck-modal .story-viewer.next');\n\n            if (!stories) {\n              modal.close();\n            } else {\n              if (option('rtl')) {\n                moveStoryItem(false);\n              } else {\n                moveStoryItem(true);\n              }\n            }\n          };\n\n          option('callbacks', 'onEnd')(zuck.internalData.currentStory, callback);\n        },\n\n        close() {\n          const modalContainer = query('#zuck-modal');\n\n          const callback = function () {\n            if (option('backNative')) {\n              window.location.hash = '';\n            }\n\n            fullScreen(modalContainer, true);\n\n            if (option('openEffect')) {\n              modalContainer.classList.add('closed');\n            } else {\n              modalContent.innerHTML = '';\n              modalContainer.style.display = 'none';\n            }\n          };\n\n          option('callbacks', 'onClose')(zuck.internalData.currentStory, callback);\n        }\n\n      };\n    };\n\n    const modal = ZuckModal();\n    /* parse functions */\n\n    const parseItems = function (story, forceUpdate) {\n      const storyId = story.getAttribute('data-id');\n      const storyItems = document.querySelectorAll(`#${id} [data-id=\"${storyId}\"] .items > li`);\n      const items = [];\n\n      if (!option('reactive') || forceUpdate) {\n        each(storyItems, (i, {\n          firstElementChild\n        }) => {\n          const a = firstElementChild;\n          const img = a.firstElementChild;\n          const item = {\n            id: a.getAttribute('data-id'),\n            src: a.getAttribute('href'),\n            length: a.getAttribute('data-length'),\n            type: a.getAttribute('data-type'),\n            time: a.getAttribute('data-time'),\n            link: a.getAttribute('data-link'),\n            linkText: a.getAttribute('data-linkText'),\n            preview: img.getAttribute('src')\n          }; // collect all attributes\n\n          const all = a.attributes; // exclude the reserved options\n\n          const reserved = ['data-id', 'href', 'data-length', 'data-type', 'data-time', 'data-link', 'data-linktext'];\n\n          for (let z = 0; z < all.length; z++) {\n            if (reserved.indexOf(all[z].nodeName) === -1) {\n              item[all[z].nodeName.replace('data-', '')] = all[z].nodeValue;\n            }\n          } // destruct the remaining attributes as options\n\n\n          items.push(item);\n        });\n        zuck.data[storyId].items = items;\n        const callback = option('callbacks', 'onDataUpdate');\n\n        if (callback) {\n          callback(zuck.data, () => {});\n        }\n      }\n    };\n\n    const parseStory = function (story, returnCallback) {\n      const storyId = story.getAttribute('data-id');\n      let seen = false;\n\n      if (zuck.internalData.seenItems[storyId]) {\n        seen = true;\n      }\n      /*\n      REACT\n      if (seen) {\n        story.classList.add('seen');\n      } else {\n        story.classList.remove('seen');\n      }\n      */\n\n\n      try {\n        if (!zuck.data[storyId]) {\n          zuck.data[storyId] = {};\n        }\n\n        zuck.data[storyId].id = storyId; // story id\n\n        zuck.data[storyId].photo = story.getAttribute('data-photo'); // story preview (or user photo)\n\n        zuck.data[storyId].name = story.querySelector('.name').innerText;\n        zuck.data[storyId].link = story.querySelector('.item-link').getAttribute('href');\n        zuck.data[storyId].lastUpdated = story.getAttribute('data-last-updated');\n        zuck.data[storyId].seen = seen;\n\n        if (!zuck.data[storyId].items) {\n          zuck.data[storyId].items = [];\n          zuck.data[storyId].noItems = true;\n        }\n      } catch (e) {\n        zuck.data[storyId] = {\n          items: []\n        };\n      }\n\n      story.onclick = e => {\n        e.preventDefault();\n        modal.show(storyId);\n      };\n\n      const callback = option('callbacks', 'onDataUpdate');\n\n      if (callback) {\n        callback(zuck.data, () => {});\n      }\n    }; // BIBLICAL\n\n\n    const getStoryMorningGlory = function (what) {\n      // my wife told me to stop singing Wonderwall. I SAID MAYBE.\n      const currentStory = zuck.internalData.currentStory;\n      const whatElementYouMean = `${what}ElementSibling`;\n\n      if (currentStory) {\n        const foundStory = query(`#${id} [data-id=\"${currentStory}\"]`)[whatElementYouMean];\n\n        if (foundStory) {\n          const storyId = foundStory.getAttribute('data-id');\n          const data = zuck.data[storyId] || false;\n          return data;\n        }\n      }\n\n      return false;\n    };\n\n    const updateStorySeenPosition = function () {\n      each(document.querySelectorAll(`#${id} .story.seen`), (i, el) => {\n        const newData = zuck.data[el.getAttribute('data-id')];\n        const timeline = el.parentNode;\n\n        if (!option('reactive')) {\n          timeline.removeChild(el);\n        }\n\n        zuck.update(newData, true);\n      });\n    };\n\n    const playVideoItem = function (storyViewer, elements, unmute) {\n      const itemElement = elements[1];\n      const itemPointer = elements[0];\n\n      if (!itemElement || !itemPointer) {\n        return false;\n      }\n\n      const cur = zuck.internalData.currentVideoElement;\n\n      if (cur) {\n        cur.pause();\n      }\n\n      if (itemElement.getAttribute('data-type') === 'video') {\n        const video = itemElement.getElementsByTagName('video')[0];\n\n        if (!video) {\n          zuck.internalData.currentVideoElement = false;\n          return false;\n        }\n\n        const setDuration = function () {\n          if (video.duration) {\n            setVendorVariable(itemPointer.getElementsByTagName('b')[0].style, 'AnimationDuration', `${video.duration}s`);\n          }\n        };\n\n        setDuration();\n        video.addEventListener('loadedmetadata', setDuration);\n        zuck.internalData.currentVideoElement = video;\n        video.play();\n\n        if (unmute && unmute.target) {\n          unmuteVideoItem(video, storyViewer);\n        }\n      } else {\n        zuck.internalData.currentVideoElement = false;\n      }\n    };\n\n    const pauseVideoItem = function () {\n      const video = zuck.internalData.currentVideoElement;\n\n      if (video) {\n        try {\n          video.pause();\n        } catch (e) {}\n      }\n    };\n\n    const unmuteVideoItem = function (video, storyViewer) {\n      video.muted = false;\n      video.volume = 1.0;\n      video.removeAttribute('muted');\n      video.play();\n\n      if (video.paused) {\n        video.muted = true;\n        video.play();\n      }\n\n      if (storyViewer) {\n        storyViewer.classList.remove('paused');\n      }\n    };\n    /* data functions */\n\n\n    const saveLocalData = function (key, data) {\n      try {\n        if (option('localStorage')) {\n          const keyName = `zuck-${id}-${key}`;\n          window.localStorage[keyName] = JSON.stringify(data);\n        }\n      } catch (e) {}\n    };\n\n    const getLocalData = function (key) {\n      if (option('localStorage')) {\n        const keyName = `zuck-${id}-${key}`;\n        return window.localStorage[keyName] ? JSON.parse(window.localStorage[keyName]) : false;\n      } else {\n        return false;\n      }\n    };\n    /* api */\n\n\n    zuck.data = option('stories') || {};\n    zuck.internalData = {};\n    zuck.internalData.seenItems = getLocalData('seenItems') || {};\n\n    zuck.add = zuck.update = (data, append) => {\n      const storyId = get(data, 'id');\n      const storyEl = query(`#${id} [data-id=\"${storyId}\"]`);\n      const items = get(data, 'items');\n      let story;\n      let preview = false;\n\n      if (items[0]) {\n        preview = items[0].preview || '';\n      }\n\n      if (zuck.internalData.seenItems[storyId] === true) {\n        data.seen = true;\n      }\n\n      data.currentPreview = preview;\n\n      if (!storyEl) {\n        const storyItem = document.createElement('div');\n        storyItem.innerHTML = option('template', 'timelineItem')(data);\n        story = storyItem.firstElementChild;\n      } else {\n        story = storyEl;\n      }\n\n      if (data.seen === false) {\n        zuck.internalData.seenItems[storyId] = false;\n        saveLocalData('seenItems', zuck.internalData.seenItems);\n      }\n\n      story.setAttribute('data-id', storyId);\n      story.setAttribute('data-photo', get(data, 'photo'));\n      story.setAttribute('data-last-updated', get(data, 'lastUpdated'));\n      parseStory(story);\n\n      if (!storyEl && !option('reactive')) {\n        if (append) {\n          timeline.appendChild(story);\n        } else {\n          prepend(timeline, story);\n        }\n      }\n\n      each(items, (i, item) => {\n        zuck.addItem(storyId, item, append);\n      });\n\n      if (!append) {\n        updateStorySeenPosition();\n      }\n    };\n\n    zuck.next = () => {\n      modal.next();\n    };\n\n    zuck.remove = storyId => {\n      const story = query(`#${id} > [data-id=\"${storyId}\"]`);\n      story.parentNode.removeChild(story);\n    };\n\n    zuck.addItem = (storyId, data, append) => {\n      const story = query(`#${id} > [data-id=\"${storyId}\"]`);\n\n      if (!option('reactive')) {\n        const li = document.createElement('li');\n        const el = story.querySelectorAll('.items')[0];\n        li.className = get(data, 'seen') ? 'seen' : '';\n        li.setAttribute('data-id', get(data, 'id')); // wow, too much jsx\n\n        li.innerHTML = option('template', 'timelineStoryItem')(data);\n\n        if (append) {\n          el.appendChild(li);\n        } else {\n          prepend(el, li);\n        }\n      }\n\n      parseItems(story);\n    };\n\n    zuck.removeItem = (storyId, itemId) => {\n      const item = query(`#${id} > [data-id=\"${storyId}\"] [data-id=\"${itemId}\"]`);\n\n      if (!option('reactive')) {\n        timeline.parentNode.removeChild(item);\n      }\n    };\n\n    zuck.navigateItem = zuck.nextItem = (direction, event) => {\n      const currentStory = zuck.internalData.currentStory;\n      const currentItem = zuck.data[currentStory].currentItem;\n      const storyViewer = query(`#zuck-modal .story-viewer[data-story-id=\"${currentStory}\"]`);\n      const directionNumber = direction === 'previous' ? -1 : 1;\n\n      if (!storyViewer || storyViewer.touchMove === 1) {\n        return false;\n      }\n\n      const currentItemElements = storyViewer.querySelectorAll(`[data-index=\"${currentItem}\"]`);\n      const currentPointer = currentItemElements[0];\n      const currentItemElement = currentItemElements[1];\n      const navigateItem = currentItem + directionNumber;\n      const nextItems = storyViewer.querySelectorAll(`[data-index=\"${navigateItem}\"]`);\n      const nextPointer = nextItems[0];\n      const nextItem = nextItems[1];\n\n      if (storyViewer && nextPointer && nextItem) {\n        const navigateItemCallback = function () {\n          if (direction === 'previous') {\n            currentPointer.classList.remove('seen');\n            currentItemElement.classList.remove('seen');\n          } else {\n            currentPointer.classList.add('seen');\n            currentItemElement.classList.add('seen');\n          }\n\n          currentPointer.classList.remove('active');\n          currentItemElement.classList.remove('active');\n          nextPointer.classList.remove('seen');\n          nextPointer.classList.add('active');\n          nextItem.classList.remove('seen');\n          nextItem.classList.add('active');\n          each(storyViewer.querySelectorAll('.time'), (i, el) => {\n            el.innerText = timeAgo(nextItem.getAttribute('data-time'));\n          });\n          zuck.data[currentStory].currentItem = zuck.data[currentStory].currentItem + directionNumber;\n          playVideoItem(storyViewer, nextItems, event);\n        };\n\n        let callback = option('callbacks', 'onNavigateItem');\n        callback = !callback ? option('callbacks', 'onNextItem') : option('callbacks', 'onNavigateItem');\n        callback(currentStory, nextItem.getAttribute('data-story-id'), navigateItemCallback);\n      } else if (storyViewer) {\n        if (direction !== 'previous') {\n          modal.next(event);\n        }\n      }\n    };\n\n    const init = function () {\n      if (timeline && timeline.querySelector('.story')) {\n        each(timeline.querySelectorAll('.story'), (storyIndex, story) => {\n          parseStory(story);\n        });\n      }\n\n      if (option('backNative')) {\n        if (window.location.hash === `#!${id}`) {\n          window.location.hash = '';\n        }\n\n        window.addEventListener('popstate', e => {\n          if (window.location.hash !== `#!${id}`) {\n            window.location.hash = '';\n          }\n        }, false);\n      }\n\n      if (!option('reactive')) {\n        const seenItems = getLocalData('seenItems');\n        each(Object.keys(seenItems), (keyIndex, key) => {\n          if (zuck.data[key]) {\n            zuck.data[key].seen = seenItems[key];\n          }\n        });\n      }\n\n      each(option('stories'), (itemKey, item) => {\n        zuck.add(item, true);\n      });\n      updateStorySeenPosition();\n      const avatars = option('avatars') ? 'user-icon' : 'story-preview';\n      const list = option('list') ? 'list' : 'carousel';\n      const rtl = option('rtl') ? 'rtl' : '';\n      timeline.className += ` stories ${avatars} ${list} ${`${option('skin')}`.toLowerCase()} ${rtl}`;\n      return zuck;\n    };\n\n    return init();\n  };\n  /* Helpers */\n\n\n  ZuckJS.buildTimelineItem = (id, photo, name, link, lastUpdated, items) => {\n    const timelineItem = {\n      id,\n      photo,\n      name,\n      link,\n      lastUpdated,\n      items: []\n    };\n    each(items, (itemIndex, itemArgs) => {\n      timelineItem.items.push(ZuckJS.buildStoryItem.apply(ZuckJS, itemArgs));\n    });\n    return timelineItem;\n  };\n\n  ZuckJS.buildStoryItem = (id, type, length, src, preview, link, linkText, seen, time) => {\n    return {\n      id,\n      type,\n      length,\n      src,\n      preview,\n      link,\n      linkText,\n      seen,\n      time\n    };\n  };\n  /* Legacy code */\n\n\n  ZuckJS.buildItem = ZuckJS.buildStoryItem; // CommonJS and Node.js module support.\n\n  if (typeof exports !== 'undefined') {\n    // Support Node.js specific `module.exports` (which can be a function)\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = ZuckJS;\n    } // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\n\n\n    exports.ZuckJS = ZuckJS;\n  } else {\n    /* Too much zuck zuck to maintain legacy */\n    window.ZuckitaDaGalera = window.Zuck = ZuckJS;\n  }\n\n  return ZuckJS;\n})(window || {});","map":{"version":3,"sources":["/Users/johnnynguyen/instagram-clone/node_modules/zuck.js/src/zuck.js"],"names":["module","exports","window","query","qs","document","querySelectorAll","get","array","what","each","arr","func","total","length","i","setVendorVariable","ref","variable","value","variables","toLowerCase","val","addVendorEvents","el","event","events","addEventListener","onAnimationEnd","onTransitionEnd","transitionEndEvent","prepend","parent","child","firstChild","insertBefore","appendChild","generateId","Math","random","toString","substr","ZuckJS","timeline","options","zuck","option","name","prop","type","optionsDefault","fullScreen","elem","cancel","elFunc","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","exitFullscreen","catch","mozCancelFullScreen","e","console","warn","translate","element","to","duration","ease","direction","to3d","abs","offsetWidth","scaling","style","transform","findPos","obj","offsetY","offsetX","stop","curleft","curtop","offsetParent","offsetLeft","offsetTop","getElementById","id","setAttribute","timeAgo","time","Number","dateObj","Date","dateStr","getTime","seconds","language","formats","minute","minutes","hour","hours","yesterday","days","currentFormat","result","formatKey","format","floor","day","getDate","month","getMonth","year","getFullYear","rtl","skin","avatars","stories","backButton","backNative","paginationArrows","previousTap","autoFullScreen","openEffect","cubeEffect","list","localStorage","callbacks","onOpen","storyId","callback","onView","onEnd","onClose","onNextItem","nextStoryId","onNavigateItem","template","timelineItem","itemData","timelineStoryItem","reserved","attributes","dataKey","indexOf","viewerItem","storyData","currentStoryItem","viewerItemPointer","index","currentIndex","item","viewerItemBody","unmute","keyboardTip","visitLink","ago","fromnow","tomorrow","ZuckModal","modalZuckContainer","hasModal","createElement","className","innerHTML","display","onkeyup","keyCode","code","modal","close","next","classList","add","contains","modalContent","remove","body","moveStoryItem","modalContainer","target","useless","modalSlider","slideItems","previous","viewing","transitionTime","slideWidth","setTimeout","tmp","currentStory","getAttribute","internalData","oldStory","parentNode","removeChild","newStoryData","getStoryMorningGlory","createStoryViewer","items","firstElementChild","data","currentItem","parseInt","cssText","nextItem","storyViewer","playVideoItem","forcePlay","storyItems","htmlItems","pointerItems","slides","exists","seen","video","querySelector","addMuted","muted","onwaiting","paused","onplay","onload","onplaying","oncanplay","onvolumechange","storyViewerWrap","onclick","preventDefault","createStoryTouchEvents","modalSliderElement","enableMouseEvents","position","touchOffset","isScrolling","delta","timer","nextTimer","touchStart","nodeName","touches","pos","slideHeight","offsetHeight","x","y","clientX","clientY","now","valid","undefined","touchMove","touchEnd","pauseVideoItem","clearInterval","lastTouchOffset","isValid","isOutOfBounds","removeEventListener","currentVideoElement","navigateItem","screen","availWidth","storyViewerViewing","unmuteVideoItem","show","page","location","hash","previousItemData","nextItemData","tryFullScreen","focus","storyEl","marginLeft","marginTop","lastStory","lastStoryTimelineElement","seenItems","saveLocalData","updateStorySeenPosition","parseItems","story","forceUpdate","a","img","src","link","linkText","preview","all","z","replace","nodeValue","push","parseStory","returnCallback","photo","innerText","lastUpdated","noItems","whatElementYouMean","foundStory","newData","update","elements","itemElement","itemPointer","cur","pause","getElementsByTagName","setDuration","play","volume","removeAttribute","key","keyName","JSON","stringify","getLocalData","parse","append","currentPreview","storyItem","addItem","li","removeItem","itemId","directionNumber","currentItemElements","currentPointer","currentItemElement","nextItems","nextPointer","navigateItemCallback","init","storyIndex","Object","keys","keyIndex","itemKey","buildTimelineItem","itemIndex","itemArgs","buildStoryItem","apply","buildItem","ZuckitaDaGalera","Zuck"],"mappings":"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","sourcesContent":["/*\n    zuck.js\n    https://github.com/ramon82/zuck.js\n    MIT License\n*/\nmodule.exports = (window => {\n  /* Utilities */\n  const query = function (qs) {\n    return document.querySelectorAll(qs)[0];\n  };\n\n  const get = function (array, what) {\n    if (array) {\n      return array[what] || '';\n    } else {\n      return '';\n    }\n  };\n\n  const each = function (arr, func) {\n    if (arr) {\n      const total = arr.length;\n\n      for (let i = 0; i < total; i++) {\n        func(i, arr[i]);\n      }\n    }\n  };\n\n  const setVendorVariable = function (ref, variable, value) {\n    const variables = [\n      variable.toLowerCase(),\n      `webkit${variable}`,\n      `MS${variable}`,\n      `o${variable}`\n    ];\n\n    each(variables, (i, val) => {\n      ref[val] = value;\n    });\n  };\n\n  const addVendorEvents = function (el, func, event) {\n    const events = [\n      event.toLowerCase(),\n      `webkit${event}`,\n      `MS${event}`,\n      `o${event}`\n    ];\n\n    each(events, (i, val) => {\n      el.addEventListener(val, func, false);\n    });\n  };\n\n  const onAnimationEnd = function (el, func) {\n    addVendorEvents(el, func, 'AnimationEnd');\n  };\n\n  const onTransitionEnd = function (el, func) {\n    if (!el.transitionEndEvent) {\n      el.transitionEndEvent = true;\n\n      addVendorEvents(el, func, 'TransitionEnd');\n    }\n  };\n\n  const prepend = function (parent, child) {\n    if (parent.firstChild) {\n      parent.insertBefore(child, parent.firstChild);\n    } else {\n      parent.appendChild(child);\n    }\n  };\n\n  const generateId = () => {\n    return 'stories-' + Math.random().toString(36).substr(2, 9);\n  };\n\n  /* Zuckera */\n  const ZuckJS = function (timeline, options) {\n    const zuck = this;\n    const option = function (name, prop) {\n      const type = function (what) {\n        return typeof what !== 'undefined';\n      };\n\n      if (prop) {\n        if (type(options[name])) {\n          return type(options[name][prop])\n            ? options[name][prop]\n            : optionsDefault[name][prop];\n        } else {\n          return optionsDefault[name][prop];\n        }\n      } else {\n        return type(options[name]) ? options[name] : optionsDefault[name];\n      }\n    };\n\n    const fullScreen = function (elem, cancel) {\n      const func = 'RequestFullScreen';\n      const elFunc = 'requestFullScreen'; // crappy vendor prefixes.\n\n      try {\n        if (cancel) {\n          if (\n            document.fullscreenElement ||\n            document.webkitFullscreenElement ||\n            document.mozFullScreenElement ||\n            document.msFullscreenElement\n          ) {\n            if (document.exitFullscreen) {\n              document.exitFullscreen()\n                .catch(() => {});\n            } else if (document.mozCancelFullScreen) {\n              document.mozCancelFullScreen()\n                .catch(() => {});\n            } else if (document.mozCancelFullScreen) {\n              document.mozCancelFullScreen()\n                .catch(() => {});\n            }\n          }\n        } else {\n          if (elem[elFunc]) {\n            elem[elFunc]();\n          } else if (elem[`ms${func}`]) {\n            elem[`ms${func}`]();\n          } else if (elem[`moz${func}`]) {\n            elem[`moz${func}`]();\n          } else if (elem[`webkit${func}`]) {\n            elem[`webkit${func}`]();\n          }\n        }\n      } catch (e) {\n        console.warn('[Zuck.js] Can\\'t access fullscreen');\n      }\n    };\n\n    const translate = function (element, to, duration, ease) {\n      const direction = to > 0 ? 1 : -1;\n      const to3d = (Math.abs(to) / query('#zuck-modal').offsetWidth) * 90 * direction;\n\n      if (option('cubeEffect')) {\n        const scaling = to3d === 0 ? 'scale(0.95)' : 'scale(0.930,0.930)';\n\n        setVendorVariable(\n          query('#zuck-modal-content').style,\n          'Transform',\n          scaling\n        );\n\n        if (to3d < -90 || to3d > 90) {\n          return false;\n        }\n      }\n\n      const transform = !option('cubeEffect')\n        ? `translate3d(${to}px, 0, 0)`\n        : `rotateY(${to3d}deg)`;\n\n      if (element) {\n        setVendorVariable(element.style, 'TransitionTimingFunction', ease);\n        setVendorVariable(element.style, 'TransitionDuration', `${duration}ms`);\n        setVendorVariable(element.style, 'Transform', transform);\n      }\n    };\n\n    const findPos = function (obj, offsetY, offsetX, stop) {\n      let curleft = 0;\n      let curtop = 0;\n\n      if (obj) {\n        if (obj.offsetParent) {\n          do {\n            curleft += obj.offsetLeft;\n            curtop += obj.offsetTop;\n\n            if (obj === stop) {\n              break;\n            }\n          } while ((obj = obj.offsetParent));\n        }\n\n        if (offsetY) {\n          curtop = curtop - offsetY;\n        }\n\n        if (offsetX) {\n          curleft = curleft - offsetX;\n        }\n      }\n\n      return [curleft, curtop];\n    };\n\n    if (typeof timeline === 'string') {\n      timeline = document.getElementById(timeline);\n    }\n\n    if (!timeline.id) {\n      timeline.setAttribute('id', generateId());\n    }\n\n    const timeAgo = function (time) {\n      time = Number(time) * 1000;\n\n      const dateObj = new Date(time);\n      const dateStr = dateObj.getTime();\n      let seconds = (new Date().getTime() - dateStr) / 1000;\n\n      const language = option('language', 'time');\n\n      const formats = [\n        [60, ` ${language.seconds}`, 1], // 60\n        [120, `1 ${language.minute}`, ''], // 60*2\n        [3600, ` ${language.minutes}`, 60], // 60*60, 60\n        [7200, `1 ${language.hour}`, ''], // 60*60*2\n        [86400, ` ${language.hours}`, 3600], // 60*60*24, 60*60\n        [172800, ` ${language.yesterday}`, ''], // 60*60*24*2\n        [604800, ` ${language.days}`, 86400]\n      ];\n\n      let currentFormat = 1;\n      if (seconds < 0) {\n        seconds = Math.abs(seconds);\n\n        currentFormat = 2;\n      }\n\n      let result = false;\n      each(formats, (formatKey, format) => {\n        if (seconds < format[0] && !result) {\n          if (typeof format[2] === 'string') {\n            result = format[currentFormat];\n          } else if (format !== null) {\n            result = Math.floor(seconds / format[2]) + format[1];\n          }\n        }\n      });\n\n      if (!result) {\n        const day = dateObj.getDate();\n        const month = dateObj.getMonth();\n        const year = dateObj.getFullYear();\n\n        return `${day}/${month + 1}/${year}`;\n      } else {\n        return result;\n      }\n    };\n\n    /* options */\n    const id = timeline.id;\n    const optionsDefault = {\n      rtl: false,\n      skin: 'snapgram',\n      avatars: true,\n      stories: [],\n      backButton: true,\n      backNative: false,\n      paginationArrows: false,\n      previousTap: true,\n      autoFullScreen: false,\n      openEffect: true,\n      cubeEffect: false,\n      list: false,\n      localStorage: true,\n      callbacks: {\n        onOpen: function (storyId, callback) {\n          callback();\n        },\n        onView: function (storyId) {},\n        onEnd: function (storyId, callback) {\n          callback();\n        },\n        onClose: function (storyId, callback) {\n          callback();\n        },\n        onNextItem: function (storyId, nextStoryId, callback) {\n          callback();\n        },\n        onNavigateItem: function (storyId, nextStoryId, callback) {\n          callback();\n        }\n      },\n      template: {\n        timelineItem (itemData) {\n          return `\n            <div class=\"story ${get(itemData, 'seen') === true ? 'seen' : ''}\">\n              <a class=\"item-link\" href=\"${get(itemData, 'link')}\">\n                <span class=\"item-preview\">\n                  <img lazy=\"eager\" src=\"${\n                    (option('avatars') || !get(itemData, 'currentPreview'))\n                    ? get(itemData, 'photo')\n                    : get(itemData, 'currentPreview')\n                  }\" />\n                </span>\n                <span class=\"info\" itemProp=\"author\" itemScope itemType=\"http://schema.org/Person\">\n                  <strong class=\"name\" itemProp=\"name\">${get(itemData, 'name')}</strong>\n                  <span class=\"time\">${get(itemData, 'lastUpdatedAgo')}</span>\n                </span>\n              </a>\n              \n              <ul class=\"items\"></ul>\n            </div>`;\n        },\n\n        timelineStoryItem (itemData) {\n          const reserved = ['id', 'seen', 'src', 'link', 'linkText', 'time', 'type', 'length', 'preview'];\n          let attributes = `\n            href=\"${get(itemData, 'src')}\"\n            data-link=\"${get(itemData, 'link')}\"\n            data-linkText=\"${get(itemData, 'linkText')}\"\n            data-time=\"${get(itemData, 'time')}\"\n            data-type=\"${get(itemData, 'type')}\"\n            data-length=\"${get(itemData, 'length')}\"\n          `;\n\n          for (const dataKey in itemData) {\n            if (reserved.indexOf(dataKey) === -1) {\n              attributes += ` data-${dataKey}=\"${itemData[dataKey]}\"`;\n            }\n          }\n\n          return `<a ${attributes}>\n                    <img loading=\"auto\" src=\"${get(itemData, 'preview')}\" />\n                  </a>`;\n        },\n\n        viewerItem (storyData, currentStoryItem) {\n          return `<div class=\"story-viewer\">\n                    <div class=\"head\">\n                      <div class=\"left\">\n                        ${option('backButton') ? '<a class=\"back\">&lsaquo;</a>' : ''}\n\n                        <span class=\"item-preview\">\n                          <img lazy=\"eager\" class=\"profilePhoto\" src=\"${get(storyData, 'photo')}\" />\n                        </span>\n\n                        <div class=\"info\">\n                          <strong class=\"name\">${get(storyData, 'name')}</strong>\n                          <span class=\"time\">${get(storyData, 'timeAgo')}</span>\n                        </div>\n                      </div>\n\n                      <div class=\"right\">\n                        <span class=\"time\">${get(currentStoryItem, 'timeAgo')}</span>\n                        <span class=\"loading\"></span>\n                        <a class=\"close\" tabIndex=\"2\">&times;</a>\n                      </div>\n                    </div>\n\n                    <div class=\"slides-pointers\">\n                      <div class=\"wrap\"></div>\n                    </div>\n\n                    ${\n                      option('paginationArrows')\n                      ? `<div class=\"slides-pagination\">\n                          <span class=\"previous\">&lsaquo;</span>\n                          <span class=\"next\">&rsaquo;</span>\n                        </div>`\n                      : ''\n                    }\n                  </div>`;\n        },\n\n        viewerItemPointer (index, currentIndex, item) {\n          return `<span \n                    class=\"${currentIndex === index ? 'active' : ''} ${get(item, 'seen') === true ? 'seen' : ''}\"\n                    data-index=\"${index}\" data-item-id=\"${get(item, 'id')}\">\n                      <b style=\"animation-duration:${get(item, 'length') === '' ? '3' : get(item, 'length')}s\"></b>\n                  </span>`;\n        },\n\n        viewerItemBody (index, currentIndex, item) {\n          return `<div \n                    class=\"item ${get(item, 'seen') === true ? 'seen' : ''} ${currentIndex === index ? 'active' : ''}\"\n                    data-time=\"${get(item, 'time')}\" data-type=\"${get(item, 'type')}\" data-index=\"${index}\" data-item-id=\"${get(item, 'id')}\">\n                    ${\n                      get(item, 'type') === 'video'\n                      ? `<video class=\"media\" muted webkit-playsinline playsinline preload=\"auto\" src=\"${get(item, 'src')}\" ${get(item, 'type')}></video>\n                        <b class=\"tip muted\">${option('language', 'unmute')}</b>`\n                      : `<img loading=\"auto\" class=\"media\" src=\"${get(item, 'src')}\" ${get(item, 'type')} />\n                    `}\n\n                    ${\n                      get(item, 'link')\n                      ? `<a class=\"tip link\" href=\"${get(item, 'link')}\" rel=\"noopener\" target=\"_blank\">\n                            ${!get(item, 'linkText') || get(item, 'linkText') === '' ? option('language', 'visitLink') : get(item, 'linkText')}\n                          </a>`\n                      : ''\n                    }\n                  </div>`;\n        }\n      },\n      language: {\n        unmute: 'Touch to unmute',\n        keyboardTip: 'Press space to see next',\n        visitLink: 'Visit link',\n        time: {\n          ago: 'ago',\n          hour: 'hour ago',\n          hours: 'hours ago',\n          minute: 'minute ago',\n          minutes: 'minutes ago',\n          fromnow: 'from now',\n          seconds: 'seconds ago',\n          yesterday: 'yesterday',\n          tomorrow: 'tomorrow',\n          days: 'days ago'\n        }\n      }\n    };\n\n    /* modal */\n    const ZuckModal = () => {\n      let modalZuckContainer = query('#zuck-modal');\n\n      if (!modalZuckContainer && !zuck.hasModal) {\n        zuck.hasModal = true;\n\n        modalZuckContainer = document.createElement('div');\n        modalZuckContainer.id = 'zuck-modal';\n\n        if (option('cubeEffect')) {\n          modalZuckContainer.className = 'with-cube';\n        }\n\n        modalZuckContainer.innerHTML = '<div id=\"zuck-modal-content\"></div>';\n        modalZuckContainer.style.display = 'none';\n\n        modalZuckContainer.setAttribute('tabIndex', '1');\n        modalZuckContainer.onkeyup = ({ keyCode }) => {\n          const code = keyCode;\n\n          if (code === 27) {\n            modal.close();\n          } else if (code === 13 || code === 32) {\n            modal.next();\n          }\n        };\n\n        if (option('openEffect')) {\n          modalZuckContainer.classList.add('with-effects');\n        }\n\n        if (option('rtl')) {\n          modalZuckContainer.classList.add('rtl');\n        }\n\n        onTransitionEnd(modalZuckContainer, () => {\n          if (modalZuckContainer.classList.contains('closed')) {\n            modalContent.innerHTML = '';\n            modalZuckContainer.style.display = 'none';\n            modalZuckContainer.classList.remove('closed');\n            modalZuckContainer.classList.remove('animated');\n          }\n        });\n\n        document.body.appendChild(modalZuckContainer);\n      }\n\n      const modalContent = query('#zuck-modal-content');\n\n      const moveStoryItem = function (direction) {\n        const modalContainer = query('#zuck-modal');\n\n        let target = '';\n        let useless = '';\n        let transform = 0;\n\n        const modalSlider = query(`#zuck-modal-slider-${id}`);\n        const slideItems = {\n          previous: query('#zuck-modal .story-viewer.previous'),\n          next: query('#zuck-modal .story-viewer.next'),\n          viewing: query('#zuck-modal .story-viewer.viewing')\n        };\n\n        if (\n          (!slideItems.previous && !direction) ||\n            (!slideItems.next && direction)\n        ) {\n          if (!option('rtl')) {\n            return false;\n          }\n        }\n\n        if (!direction) {\n          target = 'previous';\n          useless = 'next';\n        } else {\n          target = 'next';\n          useless = 'previous';\n        }\n\n        const transitionTime = 600;\n        if (option('cubeEffect')) {\n          if (target === 'previous') {\n            transform = modalContainer.slideWidth;\n          } else if (target === 'next') {\n            transform = modalContainer.slideWidth * -1;\n          }\n        } else {\n          transform = findPos(slideItems[target])[0] * -1;\n        }\n\n        translate(modalSlider, transform, transitionTime, null);\n\n        setTimeout(() => {\n          // set page data when transition complete\n          if (option('rtl')) {\n            const tmp = target;\n            target = useless;\n            useless = tmp;\n          }\n\n          if (target !== '' && slideItems[target] && useless !== '') {\n            const currentStory = slideItems[target].getAttribute('data-story-id');\n            zuck.internalData.currentStory = currentStory;\n\n            const oldStory = query(`#zuck-modal .story-viewer.${useless}`);\n            if (oldStory) {\n              oldStory.parentNode.removeChild(oldStory);\n            }\n\n            if (slideItems.viewing) {\n              slideItems.viewing.classList.add('stopped');\n              slideItems.viewing.classList.add(useless);\n              slideItems.viewing.classList.remove('viewing');\n            }\n\n            if (slideItems[target]) {\n              slideItems[target].classList.remove('stopped');\n              slideItems[target].classList.remove(target);\n              slideItems[target].classList.add('viewing');\n            }\n\n            const newStoryData = getStoryMorningGlory(target);\n            if (newStoryData) {\n              createStoryViewer(newStoryData, target);\n            }\n\n            const storyId = zuck.internalData.currentStory;\n            let items = query(`#zuck-modal [data-story-id=\"${storyId}\"]`);\n\n            if (items) {\n              items = items.querySelectorAll('[data-index].active');\n              const duration = items[0].firstElementChild;\n\n              zuck.data[storyId].currentItem = parseInt(\n                items[0].getAttribute('data-index'),\n                10\n              );\n\n              items[0].innerHTML =\n                  `<b style=\"${duration.style.cssText}\"></b>`;\n              onAnimationEnd(items[0].firstElementChild, () => {\n                zuck.nextItem(false);\n              });\n            }\n\n            translate(modalSlider, '0', 0, null);\n\n            if (items) {\n              const storyViewer = query(`#zuck-modal .story-viewer[data-story-id=\"${currentStory}\"]`);\n\n              playVideoItem(storyViewer, [items[0], items[1]], true);\n            }\n\n            option('callbacks', 'onView')(zuck.internalData.currentStory);\n          }\n        }, transitionTime + 50);\n      };\n\n      const createStoryViewer = function (storyData, className, forcePlay) {\n        const modalSlider = query(`#zuck-modal-slider-${id}`);\n        const storyItems = get(storyData, 'items');\n\n        storyData.timeAgo = storyItems && storyItems[0] ? timeAgo(get(storyItems[0], 'time')) : '';\n\n        let htmlItems = '';\n        let pointerItems = '';\n\n        const storyId = get(storyData, 'id');\n        const slides = document.createElement('div');\n        const currentItem = get(storyData, 'currentItem') || 0;\n        const exists = query(`#zuck-modal .story-viewer[data-story-id=\"${storyId}\"]`);\n\n        if (exists) {\n          return false;\n        }\n\n        slides.className = 'slides';\n        each(storyItems, (i, item) => {\n          item.timeAgo = timeAgo(get(item, 'time'));\n\n          if (currentItem > i) {\n            storyData.items[i].timeAgo = item.timeAgo;\n            storyData.items[i].seen = true;\n            item.seen = true;\n          }\n\n          pointerItems += option('template', 'viewerItemPointer')(i, currentItem, item);\n          htmlItems += option('template', 'viewerItemBody')(i, currentItem, item);\n        });\n\n        slides.innerHTML = htmlItems;\n\n        const video = slides.querySelector('video');\n        const addMuted = function (video) {\n          if (video.muted) {\n            storyViewer.classList.add('muted');\n          } else {\n            storyViewer.classList.remove('muted');\n          }\n        };\n\n        if (video) {\n          video.onwaiting = e => {\n            if (video.paused) {\n              storyViewer.classList.add('paused');\n              storyViewer.classList.add('loading');\n            }\n          };\n\n          video.onplay = () => {\n            addMuted(video);\n\n            storyViewer.classList.remove('stopped');\n            storyViewer.classList.remove('paused');\n            storyViewer.classList.remove('loading');\n          };\n\n          video.onload = video.onplaying = video.oncanplay = () => {\n            addMuted(video);\n\n            storyViewer.classList.remove('loading');\n          };\n\n          video.onvolumechange = () => {\n            addMuted(video);\n          };\n        }\n\n        const storyViewerWrap = document.createElement('div');\n        storyViewerWrap.innerHTML = option('template', 'viewerItem')(storyData, currentItem);\n\n        const storyViewer = storyViewerWrap.firstElementChild;\n\n        storyViewer.className = `story-viewer muted ${className} ${!forcePlay ? 'stopped' : ''} ${option('backButton') ? 'with-back-button' : ''}`;\n\n        storyViewer.setAttribute('data-story-id', storyId);\n        storyViewer.querySelector('.slides-pointers .wrap').innerHTML = pointerItems;\n\n        each(storyViewer.querySelectorAll('.close, .back'), (i, el) => {\n          el.onclick = e => {\n            e.preventDefault();\n            modal.close();\n          };\n        });\n\n        storyViewer.appendChild(slides);\n\n        if (className === 'viewing') {\n          playVideoItem(storyViewer, storyViewer.querySelectorAll(`[data-index=\"${currentItem}\"].active`), false);\n        }\n\n        each(storyViewer.querySelectorAll('.slides-pointers [data-index] > b'), (i, el) => {\n          onAnimationEnd(el, () => {\n            zuck.nextItem(false);\n          });\n        });\n\n        if (className === 'previous') {\n          prepend(modalSlider, storyViewer);\n        } else {\n          modalSlider.appendChild(storyViewer);\n        }\n      };\n\n      const createStoryTouchEvents = function (modalSliderElement) {\n        const modalContainer = query('#zuck-modal');\n        const enableMouseEvents = true;\n\n        const modalSlider = modalSliderElement;\n\n        let position = {};\n        let touchOffset = null;\n        let isScrolling = null;\n        let delta = null;\n        let timer = null;\n        let nextTimer = null;\n\n        const touchStart = function (event) {\n          const storyViewer = query('#zuck-modal .viewing');\n\n          if (event.target.nodeName === 'A') {\n            return;\n          }\n\n          const touches = event.touches ? event.touches[0] : event;\n          const pos = findPos(query('#zuck-modal .story-viewer.viewing'));\n\n          modalContainer.slideWidth = query('#zuck-modal .story-viewer').offsetWidth;\n          modalContainer.slideHeight = query('#zuck-modal .story-viewer').offsetHeight;\n\n          position = {\n            x: pos[0],\n            y: pos[1]\n          };\n\n          const clientX = touches.clientX;\n          const clientY = touches.clientY;\n\n          touchOffset = {\n            x: clientX,\n            y: clientY,\n            time: Date.now(),\n            valid: true\n          };\n\n          if (clientY < 80 || clientY > (modalContainer.slideHeight - 80)) {\n            touchOffset.valid = false;\n          } else {\n            event.preventDefault();\n\n            isScrolling = undefined;\n            delta = {};\n\n            if (enableMouseEvents) {\n              modalSlider.addEventListener('mousemove', touchMove);\n              modalSlider.addEventListener('mouseup', touchEnd);\n              modalSlider.addEventListener('mouseleave', touchEnd);\n            }\n            modalSlider.addEventListener('touchmove', touchMove);\n            modalSlider.addEventListener('touchend', touchEnd);\n\n            if (storyViewer) {\n              storyViewer.classList.add('paused');\n            }\n\n            pauseVideoItem();\n\n            timer = setTimeout(() => {\n              storyViewer.classList.add('longPress');\n            }, 600);\n\n            nextTimer = setTimeout(() => {\n              clearInterval(nextTimer);\n              nextTimer = false;\n            }, 250);\n          }\n        };\n\n        const touchMove = function (event) {\n          const touches = event.touches ? event.touches[0] : event;\n          const clientX = touches.clientX;\n          const clientY = touches.clientY;\n\n          if (touchOffset && touchOffset.valid) {\n            delta = {\n              x: clientX - touchOffset.x,\n              y: clientY - touchOffset.y\n            };\n\n            if (typeof isScrolling === 'undefined') {\n              isScrolling = !!(\n                isScrolling || Math.abs(delta.x) < Math.abs(delta.y)\n              );\n            }\n\n            if (!isScrolling && touchOffset) {\n              event.preventDefault();\n\n              translate(modalSlider, position.x + delta.x, 0, null);\n            }\n          }\n        };\n\n        const touchEnd = function (event) {\n          const storyViewer = query('#zuck-modal .viewing');\n          const lastTouchOffset = touchOffset;\n\n          const duration = touchOffset ? Date.now() - touchOffset.time : undefined;\n          const isValid = (Number(duration) < 300 && Math.abs(delta.x) > 25) || Math.abs(delta.x) > modalContainer.slideWidth / 3;\n          const direction = delta.x < 0;\n\n          const index = direction ? query('#zuck-modal .story-viewer.next') : query('#zuck-modal .story-viewer.previous');\n          const isOutOfBounds = (direction && !index) || (!direction && !index);\n\n          if (touchOffset && !touchOffset.valid) {\n\n          } else {\n            if (delta) {\n              if (!isScrolling) {\n                if (isValid && !isOutOfBounds) {\n                  moveStoryItem(direction);\n                } else {\n                  translate(modalSlider, position.x, 300);\n                }\n              }\n\n              touchOffset = undefined;\n\n              if (enableMouseEvents) {\n                modalSlider.removeEventListener('mousemove', touchMove);\n                modalSlider.removeEventListener('mouseup', touchEnd);\n                modalSlider.removeEventListener('mouseleave', touchEnd);\n              }\n              modalSlider.removeEventListener('touchmove', touchMove);\n              modalSlider.removeEventListener('touchend', touchEnd);\n            }\n\n            const video = zuck.internalData.currentVideoElement;\n\n            if (timer) {\n              clearInterval(timer);\n            }\n\n            if (storyViewer) {\n              playVideoItem(storyViewer, storyViewer.querySelectorAll('.active'), false);\n              storyViewer.classList.remove('longPress');\n              storyViewer.classList.remove('paused');\n            }\n\n            if (nextTimer) {\n              clearInterval(nextTimer);\n              nextTimer = false;\n\n              const navigateItem = function () {\n                if (!direction) {\n                  if (lastTouchOffset.x > window.screen.availWidth / 3 || !option('previousTap')) {\n                    if (option('rtl')) {\n                      zuck.navigateItem('previous', event);\n                    } else {\n                      zuck.navigateItem('next', event);\n                    }\n                  } else {\n                    if (option('rtl')) {\n                      zuck.navigateItem('next', event);\n                    } else {\n                      zuck.navigateItem('previous', event);\n                    }\n                  }\n                }\n              };\n\n              const storyViewerViewing = query('#zuck-modal .viewing');\n\n              if (storyViewerViewing && video) {\n                if (storyViewerViewing.classList.contains('muted')) {\n                  unmuteVideoItem(video, storyViewerViewing);\n                } else {\n                  navigateItem();\n                }\n              } else {\n                navigateItem();\n\n                return false;\n              }\n            }\n          }\n        };\n\n        modalSlider.addEventListener('touchstart', touchStart);\n        if (enableMouseEvents) {\n          modalSlider.addEventListener('mousedown', touchStart);\n        }\n      };\n\n      return {\n        show (storyId, page) {\n          const modalContainer = query('#zuck-modal');\n\n          const callback = function () {\n            modalContent.innerHTML = `<div id=\"zuck-modal-slider-${id}\" class=\"slider\"></div>`;\n\n            const storyData = zuck.data[storyId];\n            const currentItem = storyData.currentItem || 0;\n            const modalSlider = query(`#zuck-modal-slider-${id}`);\n\n            createStoryTouchEvents(modalSlider);\n\n            zuck.internalData.currentStory = storyId;\n            storyData.currentItem = currentItem;\n\n            if (option('backNative')) {\n              window.location.hash = `#!${id}`;\n            }\n\n            const previousItemData = getStoryMorningGlory('previous');\n            if (previousItemData) {\n              createStoryViewer(previousItemData, 'previous');\n            }\n\n            createStoryViewer(storyData, 'viewing', true);\n\n            const nextItemData = getStoryMorningGlory('next');\n            if (nextItemData) {\n              createStoryViewer(nextItemData, 'next');\n            }\n\n            if (option('autoFullScreen')) {\n              modalContainer.classList.add('fullscreen');\n            }\n\n            const tryFullScreen = function () {\n              if (\n                modalContainer.classList.contains('fullscreen') &&\n                  option('autoFullScreen') &&\n                  window.screen.availWidth <= 1024\n              ) {\n                fullScreen(modalContainer);\n              }\n\n              modalContainer.focus();\n            };\n\n            if (option('openEffect')) {\n              const storyEl = query(\n                `#${id} [data-id=\"${storyId}\"] .item-preview`\n              );\n              const pos = findPos(storyEl);\n\n              modalContainer.style.marginLeft = `${pos[0] + storyEl.offsetWidth / 2}px`;\n              modalContainer.style.marginTop = `${pos[1] + storyEl.offsetHeight / 2}px`;\n              modalContainer.style.display = 'block';\n\n              modalContainer.slideWidth = query('#zuck-modal .story-viewer').offsetWidth;\n\n              setTimeout(() => {\n                modalContainer.classList.add('animated');\n              }, 10);\n\n              setTimeout(() => {\n                tryFullScreen();\n              }, 300); // because effects\n            } else {\n              modalContainer.style.display = 'block';\n              modalContainer.slideWidth = query('#zuck-modal .story-viewer').offsetWidth;\n\n              tryFullScreen();\n            }\n\n            option('callbacks', 'onView')(storyId);\n          };\n\n          option('callbacks', 'onOpen')(storyId, callback);\n        },\n        next (unmute) {\n          const callback = function () {\n            const lastStory = zuck.internalData.currentStory;\n            const lastStoryTimelineElement = query(\n              `#${id} [data-id=\"${lastStory}\"]`\n            );\n\n            if (lastStoryTimelineElement) {\n              lastStoryTimelineElement.classList.add('seen');\n\n              zuck.data[lastStory].seen = true;\n              zuck.internalData.seenItems[lastStory] = true;\n\n              saveLocalData('seenItems', zuck.internalData.seenItems);\n              updateStorySeenPosition();\n            }\n\n            const stories = query('#zuck-modal .story-viewer.next');\n            if (!stories) {\n              modal.close();\n            } else {\n              if (option('rtl')) {\n                moveStoryItem(false);\n              } else {\n                moveStoryItem(true);\n              }\n            }\n          };\n\n          option('callbacks', 'onEnd')(\n            zuck.internalData.currentStory,\n            callback\n          );\n        },\n        close () {\n          const modalContainer = query('#zuck-modal');\n\n          const callback = function () {\n            if (option('backNative')) {\n              window.location.hash = '';\n            }\n\n            fullScreen(modalContainer, true);\n\n            if (option('openEffect')) {\n              modalContainer.classList.add('closed');\n            } else {\n              modalContent.innerHTML = '';\n              modalContainer.style.display = 'none';\n            }\n          };\n\n          option('callbacks', 'onClose')(zuck.internalData.currentStory, callback);\n        }\n      };\n    };\n\n    const modal = ZuckModal();\n\n    /* parse functions */\n    const parseItems = function (story, forceUpdate) {\n      const storyId = story.getAttribute('data-id');\n      const storyItems = document.querySelectorAll(`#${id} [data-id=\"${storyId}\"] .items > li`);\n      const items = [];\n\n      if (!option('reactive') || forceUpdate) {\n        each(storyItems, (i, { firstElementChild }) => {\n          const a = firstElementChild;\n          const img = a.firstElementChild;\n\n          const item = {\n            id: a.getAttribute('data-id'),\n            src: a.getAttribute('href'),\n            length: a.getAttribute('data-length'),\n            type: a.getAttribute('data-type'),\n            time: a.getAttribute('data-time'),\n            link: a.getAttribute('data-link'),\n            linkText: a.getAttribute('data-linkText'),\n            preview: img.getAttribute('src')\n          };\n\n          // collect all attributes\n          const all = a.attributes;\n          // exclude the reserved options\n          const reserved = ['data-id', 'href', 'data-length', 'data-type', 'data-time', 'data-link', 'data-linktext'];\n          for (let z = 0; z < all.length; z++) {\n            if (reserved.indexOf(all[z].nodeName) === -1) {\n              item[all[z].nodeName.replace('data-', '')] = all[z].nodeValue;\n            }\n          }\n\n          // destruct the remaining attributes as options\n          items.push(item);\n        });\n\n        zuck.data[storyId].items = items;\n\n        const callback = option('callbacks', 'onDataUpdate');\n        if (callback) {\n          callback(zuck.data, () => {});\n        }\n      }\n    };\n\n    const parseStory = function (story, returnCallback) {\n      const storyId = story.getAttribute('data-id');\n\n      let seen = false;\n\n      if (zuck.internalData.seenItems[storyId]) {\n        seen = true;\n      }\n\n      /*\n      REACT\n      if (seen) {\n        story.classList.add('seen');\n      } else {\n        story.classList.remove('seen');\n      }\n      */\n\n      try {\n        if (!zuck.data[storyId]) {\n          zuck.data[storyId] = {};\n        }\n\n        zuck.data[storyId].id = storyId; // story id\n        zuck.data[storyId].photo = story.getAttribute('data-photo'); // story preview (or user photo)\n        zuck.data[storyId].name = story.querySelector('.name').innerText;\n        zuck.data[storyId].link = story.querySelector('.item-link').getAttribute('href');\n        zuck.data[storyId].lastUpdated = story.getAttribute('data-last-updated');\n        zuck.data[storyId].seen = seen;\n\n        if (!zuck.data[storyId].items) {\n          zuck.data[storyId].items = [];\n          zuck.data[storyId].noItems = true;\n        }\n      } catch (e) {\n        zuck.data[storyId] = {\n          items: []\n        };\n      }\n\n      story.onclick = e => {\n        e.preventDefault();\n\n        modal.show(storyId);\n      };\n\n      const callback = option('callbacks', 'onDataUpdate');\n      if (callback) {\n        callback(zuck.data, () => {});\n      }\n    };\n\n    // BIBLICAL\n    const getStoryMorningGlory = function (what) {\n      // my wife told me to stop singing Wonderwall. I SAID MAYBE.\n\n      const currentStory = zuck.internalData.currentStory;\n      const whatElementYouMean = `${what}ElementSibling`;\n\n      if (currentStory) {\n        const foundStory = query(`#${id} [data-id=\"${currentStory}\"]`)[whatElementYouMean];\n\n        if (foundStory) {\n          const storyId = foundStory.getAttribute('data-id');\n          const data = zuck.data[storyId] || false;\n\n          return data;\n        }\n      }\n\n      return false;\n    };\n\n    const updateStorySeenPosition = function () {\n      each(document.querySelectorAll(`#${id} .story.seen`), (i, el) => {\n        const newData = zuck.data[el.getAttribute('data-id')];\n        const timeline = el.parentNode;\n\n        if (!option('reactive')) {\n          timeline.removeChild(el);\n        }\n\n        zuck.update(newData, true);\n      });\n    };\n\n    const playVideoItem = function (storyViewer, elements, unmute) {\n      const itemElement = elements[1];\n      const itemPointer = elements[0];\n\n      if (!itemElement || !itemPointer) {\n        return false;\n      }\n\n      const cur = zuck.internalData.currentVideoElement;\n      if (cur) {\n        cur.pause();\n      }\n\n      if (itemElement.getAttribute('data-type') === 'video') {\n        const video = itemElement.getElementsByTagName('video')[0];\n        if (!video) {\n          zuck.internalData.currentVideoElement = false;\n\n          return false;\n        }\n\n        const setDuration = function () {\n          if (video.duration) {\n            setVendorVariable(\n              itemPointer.getElementsByTagName('b')[0].style,\n              'AnimationDuration',\n              `${video.duration}s`\n            );\n          }\n        };\n\n        setDuration();\n        video.addEventListener('loadedmetadata', setDuration);\n        zuck.internalData.currentVideoElement = video;\n\n        video.play();\n\n        if (unmute && unmute.target) {\n          unmuteVideoItem(video, storyViewer);\n        }\n      } else {\n        zuck.internalData.currentVideoElement = false;\n      }\n    };\n\n    const pauseVideoItem = function () {\n      const video = zuck.internalData.currentVideoElement;\n      if (video) {\n        try {\n          video.pause();\n        } catch (e) {}\n      }\n    };\n\n    const unmuteVideoItem = function (video, storyViewer) {\n      video.muted = false;\n      video.volume = 1.0;\n      video.removeAttribute('muted');\n      video.play();\n\n      if (video.paused) {\n        video.muted = true;\n        video.play();\n      }\n\n      if (storyViewer) {\n        storyViewer.classList.remove('paused');\n      }\n    };\n\n    /* data functions */\n    const saveLocalData = function (key, data) {\n      try {\n        if (option('localStorage')) {\n          const keyName = `zuck-${id}-${key}`;\n\n          window.localStorage[keyName] = JSON.stringify(data);\n        }\n      } catch (e) {}\n    };\n\n    const getLocalData = function (key) {\n      if (option('localStorage')) {\n        const keyName = `zuck-${id}-${key}`;\n\n        return window.localStorage[keyName]\n          ? JSON.parse(window.localStorage[keyName])\n          : false;\n      } else {\n        return false;\n      }\n    };\n\n    /* api */\n    zuck.data = option('stories') || {};\n    zuck.internalData = {};\n    zuck.internalData.seenItems = getLocalData('seenItems') || {};\n\n    zuck.add = zuck.update = (data, append) => {\n      const storyId = get(data, 'id');\n      const storyEl = query(`#${id} [data-id=\"${storyId}\"]`);\n      const items = get(data, 'items');\n\n      let story;\n      let preview = false;\n\n      if (items[0]) {\n        preview = items[0].preview || '';\n      }\n\n      if (zuck.internalData.seenItems[storyId] === true) {\n        data.seen = true;\n      }\n\n      data.currentPreview = preview;\n\n      if (!storyEl) {\n        const storyItem = document.createElement('div');\n        storyItem.innerHTML = option('template', 'timelineItem')(data);\n\n        story = storyItem.firstElementChild;\n      } else {\n        story = storyEl;\n      }\n\n      if (data.seen === false) {\n        zuck.internalData.seenItems[storyId] = false;\n\n        saveLocalData('seenItems', zuck.internalData.seenItems);\n      }\n\n      story.setAttribute('data-id', storyId);\n      story.setAttribute('data-photo', get(data, 'photo'));\n      story.setAttribute('data-last-updated', get(data, 'lastUpdated'));\n\n      parseStory(story);\n\n      if (!storyEl && !option('reactive')) {\n        if (append) {\n          timeline.appendChild(story);\n        } else {\n          prepend(timeline, story);\n        }\n      }\n\n      each(items, (i, item) => {\n        zuck.addItem(storyId, item, append);\n      });\n\n      if (!append) {\n        updateStorySeenPosition();\n      }\n    };\n\n    zuck.next = () => {\n      modal.next();\n    };\n\n    zuck.remove = (storyId) => {\n      const story = query(`#${id} > [data-id=\"${storyId}\"]`);\n\n      story.parentNode.removeChild(story);\n    };\n\n    zuck.addItem = (storyId, data, append) => {\n      const story = query(`#${id} > [data-id=\"${storyId}\"]`);\n\n      if (!option('reactive')) {\n        const li = document.createElement('li');\n        const el = story.querySelectorAll('.items')[0];\n\n        li.className = get(data, 'seen') ? 'seen' : '';\n        li.setAttribute('data-id', get(data, 'id'));\n\n        // wow, too much jsx\n        li.innerHTML = option('template', 'timelineStoryItem')(data);\n\n        if (append) {\n          el.appendChild(li);\n        } else {\n          prepend(el, li);\n        }\n      }\n\n      parseItems(story);\n    };\n\n    zuck.removeItem = (storyId, itemId) => {\n      const item = query(`#${id} > [data-id=\"${storyId}\"] [data-id=\"${itemId}\"]`);\n\n      if (!option('reactive')) {\n        timeline.parentNode.removeChild(item);\n      }\n    };\n\n    zuck.navigateItem = zuck.nextItem = (direction, event) => {\n      const currentStory = zuck.internalData.currentStory;\n      const currentItem = zuck.data[currentStory].currentItem;\n      const storyViewer = query(`#zuck-modal .story-viewer[data-story-id=\"${currentStory}\"]`);\n      const directionNumber = direction === 'previous' ? -1 : 1;\n\n      if (!storyViewer || storyViewer.touchMove === 1) {\n        return false;\n      }\n\n      const currentItemElements = storyViewer.querySelectorAll(`[data-index=\"${currentItem}\"]`);\n      const currentPointer = currentItemElements[0];\n      const currentItemElement = currentItemElements[1];\n\n      const navigateItem = currentItem + directionNumber;\n      const nextItems = storyViewer.querySelectorAll(`[data-index=\"${navigateItem}\"]`);\n      const nextPointer = nextItems[0];\n      const nextItem = nextItems[1];\n\n      if (storyViewer && nextPointer && nextItem) {\n        const navigateItemCallback = function () {\n          if (direction === 'previous') {\n            currentPointer.classList.remove('seen');\n            currentItemElement.classList.remove('seen');\n          } else {\n            currentPointer.classList.add('seen');\n            currentItemElement.classList.add('seen');\n          }\n\n          currentPointer.classList.remove('active');\n          currentItemElement.classList.remove('active');\n\n          nextPointer.classList.remove('seen');\n          nextPointer.classList.add('active');\n\n          nextItem.classList.remove('seen');\n          nextItem.classList.add('active');\n\n          each(storyViewer.querySelectorAll('.time'), (i, el) => {\n            el.innerText = timeAgo(nextItem.getAttribute('data-time'));\n          });\n\n          zuck.data[currentStory].currentItem = zuck.data[currentStory].currentItem + directionNumber;\n\n          playVideoItem(storyViewer, nextItems, event);\n        };\n\n        let callback = option('callbacks', 'onNavigateItem');\n        callback = !callback ? option('callbacks', 'onNextItem') : option('callbacks', 'onNavigateItem');\n\n        callback(currentStory, nextItem.getAttribute('data-story-id'), navigateItemCallback);\n      } else if (storyViewer) {\n        if (direction !== 'previous') {\n          modal.next(event);\n        }\n      }\n    };\n\n    const init = function () {\n      if (timeline && timeline.querySelector('.story')) {\n        each(timeline.querySelectorAll('.story'), (storyIndex, story) => {\n          parseStory(story);\n        });\n      }\n\n      if (option('backNative')) {\n        if (window.location.hash === `#!${id}`) {\n          window.location.hash = '';\n        }\n\n        window.addEventListener(\n          'popstate',\n          e => {\n            if (window.location.hash !== `#!${id}`) {\n              window.location.hash = '';\n            }\n          },\n          false\n        );\n      }\n\n      if (!option('reactive')) {\n        const seenItems = getLocalData('seenItems');\n\n        each(Object.keys(seenItems), (keyIndex, key) => {\n          if (zuck.data[key]) {\n            zuck.data[key].seen = seenItems[key];\n          }\n        });\n      }\n\n      each(option('stories'), (itemKey, item) => {\n        zuck.add(item, true);\n      });\n\n      updateStorySeenPosition();\n\n      const avatars = option('avatars') ? 'user-icon' : 'story-preview';\n      const list = option('list') ? 'list' : 'carousel';\n      const rtl = option('rtl') ? 'rtl' : '';\n\n      timeline.className += ` stories ${avatars} ${list} ${(`${option('skin')}`).toLowerCase()} ${rtl}`;\n\n      return zuck;\n    };\n\n    return init();\n  };\n\n  /* Helpers */\n  ZuckJS.buildTimelineItem = (id, photo, name, link, lastUpdated, items) => {\n    const timelineItem = {\n      id,\n      photo,\n      name,\n      link,\n      lastUpdated,\n      items: []\n    };\n\n    each(items, (itemIndex, itemArgs) => {\n      timelineItem.items.push(ZuckJS.buildStoryItem.apply(ZuckJS, itemArgs));\n    });\n\n    return timelineItem;\n  };\n\n  ZuckJS.buildStoryItem = (id, type, length, src, preview, link, linkText, seen, time) => {\n    return {\n      id,\n      type,\n      length,\n      src,\n      preview,\n      link,\n      linkText,\n      seen,\n      time\n    };\n  };\n\n  /* Legacy code */\n  ZuckJS.buildItem = ZuckJS.buildStoryItem;\n\n  // CommonJS and Node.js module support.\n  if (typeof exports !== 'undefined') {\n    // Support Node.js specific `module.exports` (which can be a function)\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = ZuckJS;\n    }\n    // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\n    exports.ZuckJS = ZuckJS;\n  } else {\n    /* Too much zuck zuck to maintain legacy */\n    window.ZuckitaDaGalera = window.Zuck = ZuckJS;\n  }\n\n  return ZuckJS;\n})(window || {});\n"]},"metadata":{},"sourceType":"script"}